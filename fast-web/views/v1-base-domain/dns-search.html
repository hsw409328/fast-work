[[[define "v1-base-domain/dns-search.html"]]]
[[[template "common/header.html" .]]]
<div id="baseDomainListDiv" style="padding: 15px">
    <div class="layui-card">
        <div class="layui-card-header">
            域名结果集
        </div>
        <div class="layui-card-body">
            <table id="baseDomainListTable" lay-filter="baseDomainListTable" class="layui-table">
                <thead>
                <tr>
                    <th width="20%">域名</th>
                    <th width="20%">解析IP</th>
                    <th width="20%">Host</th>
                    <th width="20%">类型</th>
                    <th width="20%">是否可打开</th>
                </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>
    </div>
</div>
<script type="text/html" id="operationTpl">
    <button class="layui-btn-normal layui-btn-xs">获取URL资源</button>
    <button class="layui-btn-warm layui-btn-xs">查看URL结果</button>
</script>
<script>
    //一般直接写在一个js文件中
    layui.use(['layer', 'table'], function () {
        var layer = layui.layer;
        var $ = layui.jquery;
        var table = layui.table;

        var init = function (start) {
            $.get('/v1/dns/search/json?domainStr=[[[.baseDomain]]]&start=' + start, function (res) {
                if (res.data.length != 0) {
                    var htmlStr = "";
                    for (var o in res.data) {
                        htmlStr += "<tr>";
                        htmlStr += "<td>" + res.data[o].Domain + "</td>";
                        htmlStr += "<td>" + res.data[o].Ip.join(",") + "</td>";
                        htmlStr += "<td>" + res.data[o].Host + "</td>";
                        htmlStr += "<td>" + res.data[o].IsOpen + "</td>";
                        htmlStr += "<td>" + res.data[o].Type + "</td>";
                        htmlStr += "</tr>";
                    }

                    $('#tableBody').prepend(htmlStr);
                }
                setTimeout(function () {
                    init(parseInt(res.count) - 1);
                }, 2000);
            });
        };
        init(0);

        layer.open({
            type: 1,
            title: false,
            closeBtn: false,
            area: ["95%", "95%"],
            moveType: 1,
            content: $('#baseDomainListDiv'),
        });

    });
</script>
[[[template "common/footer.html" .]]]
[[[end]]]